suite: CloudfrontSite
templates:
  - cloudfrontsite.yaml
tests:
  - it: should not create a CloudFrontSite by default
    asserts:
      - hasDocuments:
          count: 0
  - it: should create a CloudFrontSite with configured fields
    set:
      global:
        ingress:
          host: example.com
      cloudfront:
        enabled: true
        domainName: cloudfront.example.com
        hostedZoneId: ZABCDEFGHIJKL
        geoRestriction:
          restrictionType: none
          locations: []
    asserts:
      - isKind:
          of: CloudFrontSite
      - isNotEmpty:
          path: metadata.name
      - equal:
          path: spec.targetOriginDomainName
          value: example.com
      - equal:
          path: spec.domainName
          value: cloudfront.example.com
      - equal:
          path: spec.hostedZoneId
          value: ZABCDEFGHIJKL
      - equal:
          path: spec.geoRestriction
          value:
            restrictionType: none
            locations: []
