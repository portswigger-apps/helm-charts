suite: Service account configuration
templates:
      - kubernetes/serviceaccount.yaml
tests:
  - it: shouldnt create service account if not enabled
    set:
      serviceAccount:
        enabled: false
    asserts:
      - hasDocuments:
          count: 0
  - it: create service account if enabled
    set:
      serviceAccount:
        enabled: true
        automountServiceAccountToken: abcdefgh
        annotations:
          my-annotation: my-value
    asserts:
      - equal:
          path: automountServiceAccountToken
          value: abcdefgh
      - equal:
          path: metadata.annotations
          value:
            my-annotation: my-value
